var ViewportPlayPlugin;(()=>{var e={61:function(e,i){var t,s;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(s="function"==typeof(t=function(e){"use strict";e.__esModule=!0,e.PLUGIN_NAME=e.DEFAULT_CONFIGS=void 0;e.PLUGIN_NAME="viewport_play_plugin";e.DEFAULT_CONFIGS={threshold:.4,firstPlayThreshold:1,timeout:500,useTsRefView:!0}})?t.apply(i,[i]):t)||(e.exports=s)},877:function(e,i,t){var s,o,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,o=[i,t(61)],s=function(e,i){"use strict";e.__esModule=!0,e.env=void 0,e.isMobileIOS=function(){return!!(navigator.userAgent&&navigator.userAgent.toLowerCase()||"").match(/iPhone|iPad|iPod/i)},e.logging=void 0;var t=window.glb&&window.glb.getCurrentEnv&&window.glb.getCurrentEnv()||"local";e.env=t;e.logging=function(e){console[e]||(e="log");for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];return console[e]("["+i.PLUGIN_NAME+"]",...s)}},void 0===(n=s.apply(i,o))||(e.exports=n)},579:function(e,i,t){var s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,void 0===(o="function"==typeof(s=function(e){"use strict";e.__esModule=!0,e.default=void 0;e.default=()=>t(871)})?s.apply(i,[i]):s)||(e.exports=o)},871:function(e,i,t){var s,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=[t(61),t(877)],void 0===(o=function(i,t){"use strict";var{Events:s,CorePlugin:o}=Clappr,{Events:n}=WP3;e.exports=class extends o{get name(){return i.PLUGIN_NAME}get supportedVersion(){return{min:Clappr.version}}get deviceGroup(){return window.cdaaas&&window.cdaaas.SETTINGS&&window.cdaaas.SETTINGS.MOBILE_GROUP||"desktop"}get enableViewportPlay(){return this.options.enableViewportPlay||!1}get shouldInit(){var e="smart"===this.deviceGroup,i=navigator&&navigator.connection&&("wifi"===navigator.connection.type||!navigator.connection.type);return e&&i||!e||(0,t.isMobileIOS)()}get isPlaying(){return this.container.isPlaying()}constructor(e){super(e),this.core=e,this.enabled=!1,this.isVideoEnded=!1,this.isAlreadyPlayed=!1,this.videoTimeoutId=null,this.uniqueId=this.core.uniqueId,this.setPluginOptions(),this.enableViewportPlay&&this.shouldInit&&(this.setUpObserver(),this.enable())}setPluginOptions(){this.pluginOptions=this.options.ViewportPlayPlugin||{};var{firstPlayThreshold:e,threshold:t,timeout:s,viewportPlayCallback:o,useTsRefView:n}=this.pluginOptions;this.firstPlayThreshold=null!=e?e:i.DEFAULT_CONFIGS.firstPlayThreshold,this.threshold=null!=t?t:i.DEFAULT_CONFIGS.threshold,this.timeout=null!=s?s:i.DEFAULT_CONFIGS.timeout,this.viewportPlayCallback=o||null,this.isUseTsRefView=null!=n?n:i.DEFAULT_CONFIGS.useTsRefView}setUpObserver(){var e=this.getOberserverTreshold();this.createIntersectionObserver(((e,i)=>this.observerCallback(e,i)),e)}getOberserverTreshold(){return this.threshold===this.firstPlayThreshold?this.threshold:[this.threshold,this.firstPlayThreshold]}createIntersectionObserver(e,i){window.IntersectionObserver&&new IntersectionObserver(((i,t)=>{e(i,t)}),{threshold:i}).observe(this.core.el)}observerCallback(e,i){e.forEach((e=>{var{intersectionRatio:t}=e;this.enabled?(this.isVideoInViewport(t)?this.playVideo():(this.pauseVideoPlaying(),this.clearVideoTimeout()),this.isAlreadyPlayed&&i.unobserve(this.core.el)):this.isAlreadyPlayed&&i.unobserve(this.core.el)}))}isVideoInViewport(e){return e>=(this.isAlreadyPlayed?this.threshold:this.firstPlayThreshold)}playVideo(){this.isPlaying||this.isVideoEnded||this.playWithDelay()}playWithDelay(){if(null===this.videoTimeoutId){var e=0,i=this.timeout,t=this.core.el.closest(".content-video");if(t&&this.isUseTsRefView){var s=t.getAttribute("data-ts-view");s&&(e=Date.now()-parseInt(s,10)),i=e>this.timeout?0:this.timeout-e}this.videoTimeoutId=setTimeout((()=>{this.enabled&&(this.container.play(),this.isAlreadyPlayed=!0,this.viewportPlayCallback&&this.viewportPlayCallback(this.container.options.source))}),i)}}pauseVideoPlaying(){this.isPlaying&&this.container.pause()}clearVideoTimeout(){null!==this.videoTimeoutId&&(clearTimeout(this.videoTimeoutId),this.videoTimeoutId=null,this.isUseTsRefView=!1)}bindEvents(){this.listenTo(this.core.mediaControl,s.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged)}onContainerChanged(){this.container&&(this.isVideoEnded=!1,this.stopListening(this.container)),this.container=this.core.getCurrentContainer(),this.listenTo(this.container,s.CONTAINER_ENDED,this.onEnded),this.listenToOnce(this.container,n.WM_UNMUTED,this.onUnmuted)}onUnmuted(){this.core.configure({mute:!1})}onEnded(){this.isVideoEnded=!0}}}.apply(i,s))||(e.exports=o)}},i={},t=function t(s){var o=i[s];if(void 0!==o)return o.exports;var n=i[s]={exports:{}};return e[s].call(n.exports,n,n.exports,t),n.exports}(579);ViewportPlayPlugin=t.default})();